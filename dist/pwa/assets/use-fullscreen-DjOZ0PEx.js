import{d as f,j as P,r as m,av as I,bj as Q,G as N,f as c,an as V,h as A,I as G,O as C,bk as F,g as B,bl as U,bm as L,aR as W,S as J}from"./index-BNMNkKPK.js";const K={ratio:[String,Number]};function X(e,l){return f(()=>{const r=Number(e.ratio||(l!==void 0?l.value:void 0));return isNaN(r)!==!0&&r>0?{paddingBottom:`${100/r}%`}:null})}const Y=1.7778,p=P({name:"QImg",props:{...K,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:Y},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:l,emit:r}){const n=m(e.initialRatio),o=X(e,n),d=B(),{registerTimeout:S,removeTimeout:i}=I(),{registerTimeout:y,removeTimeout:v}=I(),a=f(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),h=f(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),u=[m(null),m(a.value)],s=m(0),_=m(!1),w=m(!1),k=f(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),z=f(()=>({width:e.width,height:e.height})),j=f(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),x=f(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function E(){if(v(),e.loadingShowDelay===0){_.value=!0;return}y(()=>{_.value=!0},e.loadingShowDelay)}function T(){v(),_.value=!1}function H({target:t}){F(d)===!1&&(i(),n.value=t.naturalHeight===0?.5:t.naturalWidth/t.naturalHeight,R(t,1))}function R(t,g){g===1e3||F(d)===!0||(t.complete===!0?M(t):S(()=>{R(t,g+1)},50))}function M(t){F(d)!==!0&&(s.value=s.value^1,u[s.value].value=null,T(),t.getAttribute("__qerror")!=="true"&&(w.value=!1),r("load",t.currentSrc||t.src))}function D(t){i(),T(),w.value=!0,u[s.value].value=h.value,u[s.value^1].value=a.value,r("error",t)}function $(t){const g=u[t].value,q={key:"img_"+t,class:j.value,style:x.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...g};return s.value===t?Object.assign(q,{class:q.class+"current",onLoad:H,onError:D}):q.class+="loaded",c("div",{class:"q-img__container absolute-full",key:"img"+t},c("img",q))}function O(){return _.value===!1?c("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},A(l[w.value===!0?"error":"default"])):c("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},l.loading!==void 0?l.loading():e.noSpinner===!0?void 0:[c(G,{color:e.spinnerColor,size:e.spinnerSize})])}{let t=function(){C(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,g=>{i(),w.value=!1,g===null?(T(),u[s.value^1].value=a.value):E(),u[s.value].value=g},{immediate:!0})};Q.value===!0?N(t):t()}return()=>{const t=[];return o.value!==null&&t.push(c("div",{key:"filler",style:o.value})),u[0].value!==null&&t.push($(0)),u[1].value!==null&&t.push($(1)),t.push(c(V,{name:"q-transition--fade"},O)),c("div",{key:"main",class:k.value,style:z.value,role:"img","aria-label":e.alt},t)}}});let b=0;const ee={fullscreen:Boolean,noRouteFullscreenExit:Boolean},te=["update:fullscreen","fullscreen"];function ie(){const e=B(),{props:l,emit:r,proxy:n}=e;let o,d,S;const i=m(!1);U(e)===!0&&C(()=>n.$route.fullPath,()=>{l.noRouteFullscreenExit!==!0&&a()}),C(()=>l.fullscreen,h=>{i.value!==h&&y()}),C(i,h=>{r("update:fullscreen",h),r("fullscreen",h)});function y(){i.value===!0?a():v()}function v(){i.value!==!0&&(i.value=!0,S=n.$el.parentNode,S.replaceChild(d,n.$el),document.body.appendChild(n.$el),b++,b===1&&document.body.classList.add("q-body--fullscreen-mixin"),o={handler:a},L.add(o))}function a(){i.value===!0&&(o!==void 0&&(L.remove(o),o=void 0),S.replaceChild(n.$el,d),i.value=!1,b=Math.max(0,b-1),b===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),n.$el.scrollIntoView!==void 0&&setTimeout(()=>{n.$el.scrollIntoView()})))}return W(()=>{d=document.createElement("span")}),N(()=>{l.fullscreen===!0&&v()}),J(a),Object.assign(n,{toggleFullscreen:y,setFullscreen:v,exitFullscreen:a}),{inFullscreen:i,toggleFullscreen:y}}export{p as Q,ee as a,ie as b,te as u};
