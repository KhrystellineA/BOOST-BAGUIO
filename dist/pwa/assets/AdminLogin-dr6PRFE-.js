import{_ as f,y as w,o as v,w as d,p as a,n as e,A as l,v as u,a3 as y,a4 as _,a1 as g,Q as b,B as A,J as P,K as h,L as E,a6 as Q,a7 as S,aa as k,a9 as q,aJ as x,a as c,aK as p}from"./index-BNMNkKPK.js";import{Q as I}from"./QSpinnerHourglass-BIecivnK.js";import{Q as C}from"./QForm-BED6u0eC.js";import{Q as z}from"./QPage-DjjICR0a.js";import{u as B}from"./use-quasar-C3LJSxmj.js";const V={name:"BaguioBoostAdminLogin",setup(){return{$q:B()}},data(){return{email:"",password:"",showPassword:!1,loading:!1}},methods:{async onSubmit(){this.loading=!0;try{const o=this.email.trim().toLowerCase(),s=this.password,{user:t}=await x(c,o,s),r=await this.getAdminData(t.uid,t.email);if(!r)throw await p(c),this.createError("auth/not-admin","No admin profile found. Please contact the system administrator.");if(!["super_admin","route_manager","content_admin"].includes(r.role))throw await p(c),this.createError("auth/invalid-role",`Invalid role: "${r.role}". Admin access denied.`);if(r.isActive===!1)throw await p(c),this.createError("auth/account-disabled","Your admin account has been deactivated. Contact your administrator.");sessionStorage.setItem("adminRole",r.role),sessionStorage.setItem("adminData",JSON.stringify(r)),sessionStorage.setItem("adminUid",t.uid),this.$q.notify({type:"positive",message:`Welcome back, ${r.name||"Admin"}!`,icon:"check_circle",position:"top",color:"pine-green"}),this.$router.push("/admin/dashboard")}catch(o){console.error("[Admin Login] Error:",o),this.handleError(o)}finally{this.loading=!1}},async getAdminData(o,s){try{const t=P(h,"admins",o),r=await E(t);if(r.exists())return r.data();const n=Q(S(h,"admins"),k("email","==",s)),m=await q(n);return m.empty?null:m.docs[0].data()}catch(t){throw console.error("[Admin Login] Error fetching admin data:",t),t}},handleError(o){let s="Login failed. Please try again.";s={"auth/user-not-found":"No account found with this email.","auth/wrong-password":"Incorrect password.","auth/invalid-email":"Invalid email format.","auth/invalid-credential":"Invalid credentials. Check your email and password.","auth/too-many-requests":"Too many failed attempts. Try again later.","auth/not-admin":o.message,"auth/invalid-role":o.message,"auth/account-disabled":o.message}[o?.code]||o?.message||s,this.$q.notify({type:"negative",message:s,icon:"error",position:"top",timeout:5e3})},createError(o,s){const t=new Error(s);return t.code=o,t}}},D={class:"main-container"},L={class:"branding-section"},R={class:"brand-container"},M={class:"logo-wrapper"},N={class:"brand-text"},$={class:"admin-badge"},J={class:"info-cards"},T={class:"info-card"},U={class:"info-card"},F={class:"info-card"},H={class:"form-header"},K={class:"icon-wrapper"},O={class:"form-footer"},W={class:"footer-links"},j={class:"signup-link"},Y={class:"footer-text"},G={class:"jeepney-illustration"};function X(o,s,t,r,n,m){return v(),w(z,{class:"admin-login-page"},{default:d(()=>[a("div",D,[a("div",L,[a("div",R,[a("div",M,[e(l,{name:"directions_bus",size:"120px",color:"white"})]),a("div",N,[s[5]||(s[5]=a("h1",null,[u("BaguioBoost"),a("span",{class:"ph"},"PH")],-1)),a("div",$,[e(l,{name:"shield",size:"sm"}),s[4]||(s[4]=u(" Admin Control Panel ",-1))]),s[6]||(s[6]=a("div",{class:"tagline"},"Manage Routes • Places • Events",-1))])]),a("div",J,[a("div",T,[e(l,{name:"route",size:"md"}),s[7]||(s[7]=a("span",null,"Route Management",-1))]),a("div",U,[e(l,{name:"place",size:"md"}),s[8]||(s[8]=a("span",null,"Place Directory",-1))]),a("div",F,[e(l,{name:"event",size:"md"}),s[9]||(s[9]=a("span",null,"Event Calendar",-1))])])]),e(y,{class:"login-card"},{default:d(()=>[e(_,null,{default:d(()=>[a("div",H,[a("div",K,[e(l,{name:"admin_panel_settings",size:"42px",style:{background:"#2d6a4f",color:"white"}})]),s[10]||(s[10]=a("h3",null,"Admin Login",-1)),s[11]||(s[11]=a("p",{class:"subtitle"},"Route Managers & Content Admins",-1))]),e(C,{onSubmit:m.onSubmit,class:"login-form"},{default:d(()=>[e(g,{modelValue:n.email,"onUpdate:modelValue":s[0]||(s[0]=i=>n.email=i),outlined:"",label:"Admin Email",type:"email",class:"q-mb-md",rules:[i=>!!i||"Email required",i=>/.+@.+\..+/.test(i)||"Invalid email"],autocomplete:"username","bg-color":"grey-1"},{prepend:d(()=>[e(l,{name:"mail",style:{background:"#2d6a4f",color:"white"}})]),_:1},8,["modelValue","rules"]),e(g,{modelValue:n.password,"onUpdate:modelValue":s[2]||(s[2]=i=>n.password=i),outlined:"",label:"Password",type:n.showPassword?"text":"password",class:"q-mb-md",rules:[i=>!!i||"Password required",i=>i.length>=6||"Min 6 characters"],autocomplete:"current-password","bg-color":"grey-1"},{prepend:d(()=>[e(l,{name:"lock",style:{background:"#2d6a4f",color:"white"}})]),append:d(()=>[e(l,{name:n.showPassword?"visibility":"visibility_off",class:"cursor-pointer",color:"grey-6",onClick:s[1]||(s[1]=i=>n.showPassword=!n.showPassword)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),e(b,{type:"submit",label:"Access Admin Panel",unelevated:"","no-caps":"",class:"full-width login-btn",size:"lg",loading:n.loading},{loading:d(()=>[e(I,{color:"white"})]),_:1},8,["loading"])]),_:1},8,["onSubmit"]),a("div",O,[e(A,{class:"q-my-md"}),a("div",W,[a("div",j,[s[12]||(s[12]=u(" Don't have an account? ",-1)),a("a",{onClick:s[3]||(s[3]=i=>o.$router.push("/admin/signup"))},"Sign up here")]),a("div",Y,[e(l,{name:"info",size:"xs",color:"grey-6"}),s[13]||(s[13]=a("span",null,"For admin access issues, contact system administrator",-1))])])])]),_:1})]),_:1})]),a("div",G,[e(l,{name:"directions_bus",size:"180px",color:"white",style:{opacity:"0.1"}})])]),_:1})}const ts=f(V,[["render",X],["__scopeId","data-v-50c5c002"]]);export{ts as default};
